# 前端数据标注流程开发规划

## 📋 项目现状分析

**日期：** 2025年6月5日
**状态：** 规划阶段
**负责：** AI Assistant + Developer协同

### 后端基础（✅ 已完善）
- **技术栈：** FastAPI + SQLAlchemy + SQLite
- **数据规模：** 114,304条标注数据，115个标签
- **API完整性：** 
  - 标注数据CRUD（创建、读取、更新、删除）
  - 标签管理（增删查）
  - 搜索和筛选（支持多条件）
  - 批量操作（批量标注）
  - 统计接口（系统统计、标签分布）
  - 健康检查

### 前端基础（🔧 需要扩展）
- **技术栈：** Vue 3 + TypeScript + Element Plus + Pinia
- **已有架构：**
  - ✅ stores：annotation.ts, label.ts, app.ts
  - ✅ services：api.ts（完整的API封装）
  - ✅ types：api.ts（完整的类型定义）
  - ✅ router：基础路由配置
- **当前页面：** 仅有HomePage.vue（统计展示）
- **缺失功能：** 数据标注工作界面

## 🎯 Minimal数据标注流程设计

### 核心用户场景
1. **标注员快速标注**：查看文本 → 分配标签 → 跳转下一条
2. **批量处理**：选择多条文本 → 批量分配标签
3. **数据管理**：筛选、搜索、统计标注进度
4. **标签管理**：添加、删除、修改标签

### 工作流程设计
```
[选择筛选条件] → [文本列表展示] → [选择文本] → [查看内容] → [分配标签] → [自动跳转下一条]
                                    ↓
[批量选择] → [批量标注] → [返回列表]
```

## 📁 前端架构规划

### 页面结构
```
frontend/src/pages/
├── HomePage.vue          # ✅ 统计展示页面（已有）
├── AnnotationPage.vue    # 🆕 核心标注工作台
└── LabelManagePage.vue   # 🆕 标签管理页面
```

### 组件设计
```
frontend/src/components/
├── annotation/           # 标注相关组件
│   ├── TextList.vue      # 文本列表（分页、筛选、搜索）
│   ├── TextViewer.vue    # 文本内容展示
│   ├── LabelSelector.vue # 标签选择器（支持快捷键）
│   └── BatchOperations.vue # 批量操作工具
├── label/               # 标签管理组件
│   ├── LabelForm.vue    # 标签表单
│   └── LabelStats.vue   # 标签统计
└── common/              # 通用组件
    ├── PageHeader.vue   # 页面头部
    └── LoadingState.vue # 加载状态
```

### 路由规划
```javascript
const routes = [
  { path: '/', redirect: '/home' },
  { path: '/home', component: HomePage },           // 统计首页
  { path: '/annotation', component: AnnotationPage }, // 标注工作台
  { path: '/labels', component: LabelManagePage },   // 标签管理
  { path: '/annotation/:id', component: AnnotationDetail } // 单条详情（可选）
]
```

## 🚀 分阶段实施计划

### 阶段1：核心标注功能（高优先级，1-2天）

**目标：** 实现基础的标注工作流程

**任务清单：**
1. **AnnotationPage.vue** - 主标注工作台
   - 三栏布局：文本列表 | 当前文本 | 标签选择器
   - 基础的文本展示和标签分配
   - 简单的筛选（已标注/未标注）

2. **TextList组件**
   - 分页文本列表
   - 点击选择当前文本
   - 标注状态指示器

3. **LabelSelector组件**
   - 标签选择界面
   - 保存标注功能
   - 跳转下一条功能

4. **路由集成**
   - 添加 `/annotation` 路由
   - 在首页添加"开始标注"入口

**验收标准：**
- [ ] 能够浏览文本列表
- [ ] 能够为文本分配标签
- [ ] 能够保存标注并跳转下一条
- [ ] 基础的筛选功能正常

### 阶段2：标签管理（中优先级，1天）

**目标：** 完善标签管理功能

**任务清单：**
1. **LabelManagePage.vue** - 标签管理页面
2. **LabelForm组件** - 添加/编辑标签
3. **LabelStats组件** - 标签使用统计

**验收标准：**
- [ ] 能够查看所有标签
- [ ] 能够添加新标签
- [ ] 能够删除标签
- [ ] 显示标签使用统计

### 阶段3：增强功能（低优先级，1-2天）

**目标：** 提升用户体验和操作效率

**任务清单：**
1. **快捷键支持**
   - 1-9数字键对应前9个标签
   - 方向键导航文本
   - Enter保存，Space跳过

2. **批量操作**
   - 多选文本功能
   - 批量分配标签
   - 批量删除

3. **高级筛选**
   - 按标签筛选
   - 文本内容搜索
   - 日期范围筛选

4. **进度跟踪**
   - 标注进度条
   - 工作会话统计
   - 自动保存标注位置

**验收标准：**
- [ ] 键盘快捷键正常工作
- [ ] 批量操作功能完整
- [ ] 搜索筛选准确
- [ ] 进度跟踪清晰

## 💡 设计原则

### 1. 效率优先
- **快捷键支持**：数字键、方向键、功能键
- **自动跳转**：标注完成自动到下一条
- **智能筛选**：记住用户偏好

### 2. 用户体验
- **清晰布局**：三栏式，信息层次分明
- **实时反馈**：操作结果即时显示
- **响应式设计**：适配不同屏幕尺寸

### 3. 技术稳健
- **复用现有架构**：充分利用stores和API
- **类型安全**：TypeScript全覆盖
- **组件复用**：Element Plus组件一致性

## 🔧 技术实施细节

### 数据流设计
```javascript
// 标注工作台的数据流
AnnotationPage.vue
├── 使用 annotationStore.searchAnnotations() 获取文本列表
├── 使用 labelStore.fetchLabels() 获取标签列表
├── 使用 annotationStore.updateAnnotation() 保存标注
└── 响应式更新UI状态
```

### 状态管理扩展
```javascript
// annotationStore 需要添加的状态
{
  currentIndex: 0,          // 当前文本索引
  filterOptions: {          // 筛选选项
    unlabeled_only: true,
    query: '',
    labels: ''
  },
  annotationSession: {      // 标注会话
    startTime: Date,
    annotatedCount: 0
  }
}
```

### 组件通信
- **页面→组件**：通过props传递数据
- **组件→页面**：通过emit事件通信
- **全局状态**：通过Pinia stores管理

## ⚠️ 风险和注意事项

### 技术风险
1. **大数据量性能**：11万+条数据的分页和搜索优化
2. **快捷键冲突**：避免与浏览器快捷键冲突
3. **状态同步**：多组件间状态保持一致

### 用户体验风险
1. **学习成本**：确保界面直观易用
2. **误操作**：添加确认机制和撤销功能
3. **标注质量**：提供标注指南和质量检查

### 解决方案
- **性能优化**：虚拟滚动、懒加载、防抖搜索
- **操作安全**：操作确认、自动保存、历史记录
- **用户引导**：操作提示、快捷键说明、使用教程

## 📊 成功指标

### 功能指标
- [ ] 标注效率：每分钟可标注文本数量
- [ ] 操作准确性：误操作率 < 5%
- [ ] 系统响应性：页面加载 < 2秒

### 用户体验指标
- [ ] 界面直观性：新用户5分钟内上手
- [ ] 操作流畅性：无明显卡顿
- [ ] 功能完整性：覆盖核心标注场景

## 🤝 协作说明

### 开发流程
1. **架构确认**：与团队确认技术方案
2. **组件开发**：按阶段逐步实现
3. **集成测试**：每个阶段完成后测试
4. **用户反馈**：实际使用中收集改进意见

### 代码规范
- **组件命名**：PascalCase，语义化命名
- **文件组织**：按功能模块分组
- **类型定义**：完整的TypeScript类型
- **注释说明**：关键逻辑添加注释

### 文档维护
- **更新进度**：定期更新本文档
- **记录变更**：重要设计变更要记录
- **分享经验**：开发中的最佳实践

---

**下一步行动：** 开始阶段1的开发，创建AnnotationPage.vue和核心组件

**预期完成时间：** 阶段1（2-3天），完整功能（1周）

**联系方式：** 有问题随时在项目中讨论 